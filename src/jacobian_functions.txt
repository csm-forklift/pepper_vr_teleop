cp derivative:
[[[(-2.0*ewx*(-sin(qer)*sin(qey)*sin(qsp) + sin(qer)*sin(qsr)*cos(qey)*cos(qsp) - cos(qer)*cos(qsp)*cos(qsr)) - 2.0*ewy*(sin(qer)*cos(qsp)*cos(qsr) - sin(qey)*sin(qsp)*cos(qer) + sin(qsr)*cos(qer)*cos(qey)*cos(qsp)) - 2.0*ewz*(-sin(qey)*sin(qsr)*cos(qsp) - sin(qsp)*cos(qey)) + 2.0*sex*cos(qsp)*cos(qsr) - 2.0*sey*sin(qsr)*cos(qsp) + 2.0*sez*sin(qsp) - 2*whx*(-sin(qer)*sin(qey)*sin(qsp) + sin(qer)*sin(qsr)*cos(qey)*cos(qsp) - cos(qer)*cos(qsp)*cos(qsr)) - 2*why*(sin(qer)*cos(qsp)*cos(qsr) - sin(qey)*sin(qsp)*cos(qer) + sin(qsr)*cos(qer)*cos(qey)*cos(qsp)) - 2*whz*(-sin(qey)*sin(qsr)*cos(qsp) - sin(qsp)*cos(qey)))*(-1.0*bsz - 1.0*ewx*(sin(qer)*sin(qey)*cos(qsp) + sin(qer)*sin(qsp)*sin(qsr)*cos(qey) - sin(qsp)*cos(qer)*cos(qsr)) - 1.0*ewy*(sin(qer)*sin(qsp)*cos(qsr) + sin(qey)*cos(qer)*cos(qsp) + sin(qsp)*sin(qsr)*cos(qer)*cos(qey)) - 1.0*ewz*(-sin(qey)*sin(qsp)*sin(qsr) + cos(qey)*cos(qsp)) + 1.0*sex*sin(qsp)*cos(qsr) - 1.0*sey*sin(qsp)*sin(qsr) - 1.0*sez*cos(qsp) + spz - whx*(sin(qer)*sin(qey)*cos(qsp) + sin(qer)*sin(qsp)*sin(qsr)*cos(qey) - sin(qsp)*cos(qer)*cos(qsr)) - why*(sin(qer)*sin(qsp)*cos(qsr) + sin(qey)*cos(qer)*cos(qsp) + sin(qsp)*sin(qsr)*cos(qer)*cos(qey)) - whz*(-sin(qey)*sin(qsp)*sin(qsr) + cos(qey)*cos(qsp))) + (-2.0*ewx*(sin(qer)*sin(qey)*cos(qsp) + sin(qer)*sin(qsp)*sin(qsr)*cos(qey) - sin(qsp)*cos(qer)*cos(qsr)) - 2.0*ewy*(sin(qer)*sin(qsp)*cos(qsr) + sin(qey)*cos(qer)*cos(qsp) + sin(qsp)*sin(qsr)*cos(qer)*cos(qey)) - 2.0*ewz*(-sin(qey)*sin(qsp)*sin(qsr) + cos(qey)*cos(qsp)) + 2.0*sex*sin(qsp)*cos(qsr) - 2.0*sey*sin(qsp)*sin(qsr) - 2.0*sez*cos(qsp) - 2*whx*(sin(qer)*sin(qey)*cos(qsp) + sin(qer)*sin(qsp)*sin(qsr)*cos(qey) - sin(qsp)*cos(qer)*cos(qsr)) - 2*why*(sin(qer)*sin(qsp)*cos(qsr) + sin(qey)*cos(qer)*cos(qsp) + sin(qsp)*sin(qsr)*cos(qer)*cos(qey)) - 2*whz*(-sin(qey)*sin(qsp)*sin(qsr) + cos(qey)*cos(qsp)))*(-1.0*bsx - 1.0*ewx*(sin(qer)*sin(qey)*sin(qsp) - sin(qer)*sin(qsr)*cos(qey)*cos(qsp) + cos(qer)*cos(qsp)*cos(qsr)) - 1.0*ewy*(-sin(qer)*cos(qsp)*cos(qsr) + sin(qey)*sin(qsp)*cos(qer) - sin(qsr)*cos(qer)*cos(qey)*cos(qsp)) - 1.0*ewz*(sin(qey)*sin(qsr)*cos(qsp) + sin(qsp)*cos(qey)) - 1.0*sex*cos(qsp)*cos(qsr) + 1.0*sey*sin(qsr)*cos(qsp) - 1.0*sez*sin(qsp) + spx - whx*(sin(qer)*sin(qey)*sin(qsp) - sin(qer)*sin(qsr)*cos(qey)*cos(qsp) + cos(qer)*cos(qsp)*cos(qsr)) - why*(-sin(qer)*cos(qsp)*cos(qsr) + sin(qey)*sin(qsp)*cos(qer) - sin(qsr)*cos(qer)*cos(qey)*cos(qsp)) - whz*(sin(qey)*sin(qsr)*cos(qsp) + sin(qsp)*cos(qey)))]]]
[]
[[[(-2.0*ewx*(-sin(qer)*sin(qsr)*cos(qey) + cos(qer)*cos(qsr)) - 2.0*ewy*(-sin(qer)*cos(qsr) - sin(qsr)*cos(qer)*cos(qey)) - 2.0*ewz*sin(qey)*sin(qsr) - 2.0*sex*cos(qsr) + 2.0*sey*sin(qsr) - 2*whx*(-sin(qer)*sin(qsr)*cos(qey) + cos(qer)*cos(qsr)) - 2*why*(-sin(qer)*cos(qsr) - sin(qsr)*cos(qer)*cos(qey)) - 2*whz*sin(qey)*sin(qsr))*(-1.0*bsy - 1.0*ewx*(sin(qer)*cos(qey)*cos(qsr) + sin(qsr)*cos(qer)) - 1.0*ewy*(-sin(qer)*sin(qsr) + cos(qer)*cos(qey)*cos(qsr)) + 1.0*ewz*sin(qey)*cos(qsr) - 1.0*sex*sin(qsr) - 1.0*sey*cos(qsr) + spy - whx*(sin(qer)*cos(qey)*cos(qsr) + sin(qsr)*cos(qer)) - why*(-sin(qer)*sin(qsr) + cos(qer)*cos(qey)*cos(qsr)) + whz*sin(qey)*cos(qsr)) + (-2.0*ewx*(sin(qer)*sin(qsp)*cos(qey)*cos(qsr) + sin(qsp)*sin(qsr)*cos(qer)) - 2.0*ewy*(-sin(qer)*sin(qsp)*sin(qsr) + sin(qsp)*cos(qer)*cos(qey)*cos(qsr)) + 2.0*ewz*sin(qey)*sin(qsp)*cos(qsr) - 2.0*sex*sin(qsp)*sin(qsr) - 2.0*sey*sin(qsp)*cos(qsr) - 2*whx*(sin(qer)*sin(qsp)*cos(qey)*cos(qsr) + sin(qsp)*sin(qsr)*cos(qer)) - 2*why*(-sin(qer)*sin(qsp)*sin(qsr) + sin(qsp)*cos(qer)*cos(qey)*cos(qsr)) + 2*whz*sin(qey)*sin(qsp)*cos(qsr))*(-1.0*bsz - 1.0*ewx*(sin(qer)*sin(qey)*cos(qsp) + sin(qer)*sin(qsp)*sin(qsr)*cos(qey) - sin(qsp)*cos(qer)*cos(qsr)) - 1.0*ewy*(sin(qer)*sin(qsp)*cos(qsr) + sin(qey)*cos(qer)*cos(qsp) + sin(qsp)*sin(qsr)*cos(qer)*cos(qey)) - 1.0*ewz*(-sin(qey)*sin(qsp)*sin(qsr) + cos(qey)*cos(qsp)) + 1.0*sex*sin(qsp)*cos(qsr) - 1.0*sey*sin(qsp)*sin(qsr) - 1.0*sez*cos(qsp) + spz - whx*(sin(qer)*sin(qey)*cos(qsp) + sin(qer)*sin(qsp)*sin(qsr)*cos(qey) - sin(qsp)*cos(qer)*cos(qsr)) - why*(sin(qer)*sin(qsp)*cos(qsr) + sin(qey)*cos(qer)*cos(qsp) + sin(qsp)*sin(qsr)*cos(qer)*cos(qey)) - whz*(-sin(qey)*sin(qsp)*sin(qsr) + cos(qey)*cos(qsp))) + (-2.0*ewx*(-sin(qer)*cos(qey)*cos(qsp)*cos(qsr) - sin(qsr)*cos(qer)*cos(qsp)) - 2.0*ewy*(sin(qer)*sin(qsr)*cos(qsp) - cos(qer)*cos(qey)*cos(qsp)*cos(qsr)) - 2.0*ewz*sin(qey)*cos(qsp)*cos(qsr) + 2.0*sex*sin(qsr)*cos(qsp) + 2.0*sey*cos(qsp)*cos(qsr) - 2*whx*(-sin(qer)*cos(qey)*cos(qsp)*cos(qsr) - sin(qsr)*cos(qer)*cos(qsp)) - 2*why*(sin(qer)*sin(qsr)*cos(qsp) - cos(qer)*cos(qey)*cos(qsp)*cos(qsr)) - 2*whz*sin(qey)*cos(qsp)*cos(qsr))*(-1.0*bsx - 1.0*ewx*(sin(qer)*sin(qey)*sin(qsp) - sin(qer)*sin(qsr)*cos(qey)*cos(qsp) + cos(qer)*cos(qsp)*cos(qsr)) - 1.0*ewy*(-sin(qer)*cos(qsp)*cos(qsr) + sin(qey)*sin(qsp)*cos(qer) - sin(qsr)*cos(qer)*cos(qey)*cos(qsp)) - 1.0*ewz*(sin(qey)*sin(qsr)*cos(qsp) + sin(qsp)*cos(qey)) - 1.0*sex*cos(qsp)*cos(qsr) + 1.0*sey*sin(qsr)*cos(qsp) - 1.0*sez*sin(qsp) + spx - whx*(sin(qer)*sin(qey)*sin(qsp) - sin(qer)*sin(qsr)*cos(qey)*cos(qsp) + cos(qer)*cos(qsp)*cos(qsr)) - why*(-sin(qer)*cos(qsp)*cos(qsr) + sin(qey)*sin(qsp)*cos(qer) - sin(qsr)*cos(qer)*cos(qey)*cos(qsp)) - whz*(sin(qey)*sin(qsr)*cos(qsp) + sin(qsp)*cos(qey)))]]]
[]
[[[(-2.0*ewx*(-sin(qer)*sin(qey)*sin(qsp)*sin(qsr) + sin(qer)*cos(qey)*cos(qsp)) - 2.0*ewy*(-sin(qey)*sin(qsp)*sin(qsr)*cos(qer) + cos(qer)*cos(qey)*cos(qsp)) - 2.0*ewz*(-sin(qey)*cos(qsp) - sin(qsp)*sin(qsr)*cos(qey)) - 2*whx*(-sin(qer)*sin(qey)*sin(qsp)*sin(qsr) + sin(qer)*cos(qey)*cos(qsp)) - 2*why*(-sin(qey)*sin(qsp)*sin(qsr)*cos(qer) + cos(qer)*cos(qey)*cos(qsp)) - 2*whz*(-sin(qey)*cos(qsp) - sin(qsp)*sin(qsr)*cos(qey)))*(-1.0*bsz - 1.0*ewx*(sin(qer)*sin(qey)*cos(qsp) + sin(qer)*sin(qsp)*sin(qsr)*cos(qey) - sin(qsp)*cos(qer)*cos(qsr)) - 1.0*ewy*(sin(qer)*sin(qsp)*cos(qsr) + sin(qey)*cos(qer)*cos(qsp) + sin(qsp)*sin(qsr)*cos(qer)*cos(qey)) - 1.0*ewz*(-sin(qey)*sin(qsp)*sin(qsr) + cos(qey)*cos(qsp)) + 1.0*sex*sin(qsp)*cos(qsr) - 1.0*sey*sin(qsp)*sin(qsr) - 1.0*sez*cos(qsp) + spz - whx*(sin(qer)*sin(qey)*cos(qsp) + sin(qer)*sin(qsp)*sin(qsr)*cos(qey) - sin(qsp)*cos(qer)*cos(qsr)) - why*(sin(qer)*sin(qsp)*cos(qsr) + sin(qey)*cos(qer)*cos(qsp) + sin(qsp)*sin(qsr)*cos(qer)*cos(qey)) - whz*(-sin(qey)*sin(qsp)*sin(qsr) + cos(qey)*cos(qsp))) + (-2.0*ewx*(sin(qer)*sin(qey)*sin(qsr)*cos(qsp) + sin(qer)*sin(qsp)*cos(qey)) - 2.0*ewy*(sin(qey)*sin(qsr)*cos(qer)*cos(qsp) + sin(qsp)*cos(qer)*cos(qey)) - 2.0*ewz*(-sin(qey)*sin(qsp) + sin(qsr)*cos(qey)*cos(qsp)) - 2*whx*(sin(qer)*sin(qey)*sin(qsr)*cos(qsp) + sin(qer)*sin(qsp)*cos(qey)) - 2*why*(sin(qey)*sin(qsr)*cos(qer)*cos(qsp) + sin(qsp)*cos(qer)*cos(qey)) - 2*whz*(-sin(qey)*sin(qsp) + sin(qsr)*cos(qey)*cos(qsp)))*(-1.0*bsx - 1.0*ewx*(sin(qer)*sin(qey)*sin(qsp) - sin(qer)*sin(qsr)*cos(qey)*cos(qsp) + cos(qer)*cos(qsp)*cos(qsr)) - 1.0*ewy*(-sin(qer)*cos(qsp)*cos(qsr) + sin(qey)*sin(qsp)*cos(qer) - sin(qsr)*cos(qer)*cos(qey)*cos(qsp)) - 1.0*ewz*(sin(qey)*sin(qsr)*cos(qsp) + sin(qsp)*cos(qey)) - 1.0*sex*cos(qsp)*cos(qsr) + 1.0*sey*sin(qsr)*cos(qsp) - 1.0*sez*sin(qsp) + spx - whx*(sin(qer)*sin(qey)*sin(qsp) - sin(qer)*sin(qsr)*cos(qey)*cos(qsp) + cos(qer)*cos(qsp)*cos(qsr)) - why*(-sin(qer)*cos(qsp)*cos(qsr) + sin(qey)*sin(qsp)*cos(qer) - sin(qsr)*cos(qer)*cos(qey)*cos(qsp)) - whz*(sin(qey)*sin(qsr)*cos(qsp) + sin(qsp)*cos(qey))) + (2.0*ewx*sin(qer)*sin(qey)*cos(qsr) + 2.0*ewy*sin(qey)*cos(qer)*cos(qsr) + 2.0*ewz*cos(qey)*cos(qsr) + 2*whx*sin(qer)*sin(qey)*cos(qsr) + 2*why*sin(qey)*cos(qer)*cos(qsr) + 2*whz*cos(qey)*cos(qsr))*(-1.0*bsy - 1.0*ewx*(sin(qer)*cos(qey)*cos(qsr) + sin(qsr)*cos(qer)) - 1.0*ewy*(-sin(qer)*sin(qsr) + cos(qer)*cos(qey)*cos(qsr)) + 1.0*ewz*sin(qey)*cos(qsr) - 1.0*sex*sin(qsr) - 1.0*sey*cos(qsr) + spy - whx*(sin(qer)*cos(qey)*cos(qsr) + sin(qsr)*cos(qer)) - why*(-sin(qer)*sin(qsr) + cos(qer)*cos(qey)*cos(qsr)) + whz*sin(qey)*cos(qsr))]]]
[]
[[[(-2.0*ewx*(-sin(qer)*sin(qsr) + cos(qer)*cos(qey)*cos(qsr)) - 2.0*ewy*(-sin(qer)*cos(qey)*cos(qsr) - sin(qsr)*cos(qer)) - 2*whx*(-sin(qer)*sin(qsr) + cos(qer)*cos(qey)*cos(qsr)) - 2*why*(-sin(qer)*cos(qey)*cos(qsr) - sin(qsr)*cos(qer)))*(-1.0*bsy - 1.0*ewx*(sin(qer)*cos(qey)*cos(qsr) + sin(qsr)*cos(qer)) - 1.0*ewy*(-sin(qer)*sin(qsr) + cos(qer)*cos(qey)*cos(qsr)) + 1.0*ewz*sin(qey)*cos(qsr) - 1.0*sex*sin(qsr) - 1.0*sey*cos(qsr) + spy - whx*(sin(qer)*cos(qey)*cos(qsr) + sin(qsr)*cos(qer)) - why*(-sin(qer)*sin(qsr) + cos(qer)*cos(qey)*cos(qsr)) + whz*sin(qey)*cos(qsr)) + (-2.0*ewx*(sin(qer)*sin(qsp)*cos(qsr) + sin(qey)*cos(qer)*cos(qsp) + sin(qsp)*sin(qsr)*cos(qer)*cos(qey)) - 2.0*ewy*(-sin(qer)*sin(qey)*cos(qsp) - sin(qer)*sin(qsp)*sin(qsr)*cos(qey) + sin(qsp)*cos(qer)*cos(qsr)) - 2*whx*(sin(qer)*sin(qsp)*cos(qsr) + sin(qey)*cos(qer)*cos(qsp) + sin(qsp)*sin(qsr)*cos(qer)*cos(qey)) - 2*why*(-sin(qer)*sin(qey)*cos(qsp) - sin(qer)*sin(qsp)*sin(qsr)*cos(qey) + sin(qsp)*cos(qer)*cos(qsr)))*(-1.0*bsz - 1.0*ewx*(sin(qer)*sin(qey)*cos(qsp) + sin(qer)*sin(qsp)*sin(qsr)*cos(qey) - sin(qsp)*cos(qer)*cos(qsr)) - 1.0*ewy*(sin(qer)*sin(qsp)*cos(qsr) + sin(qey)*cos(qer)*cos(qsp) + sin(qsp)*sin(qsr)*cos(qer)*cos(qey)) - 1.0*ewz*(-sin(qey)*sin(qsp)*sin(qsr) + cos(qey)*cos(qsp)) + 1.0*sex*sin(qsp)*cos(qsr) - 1.0*sey*sin(qsp)*sin(qsr) - 1.0*sez*cos(qsp) + spz - whx*(sin(qer)*sin(qey)*cos(qsp) + sin(qer)*sin(qsp)*sin(qsr)*cos(qey) - sin(qsp)*cos(qer)*cos(qsr)) - why*(sin(qer)*sin(qsp)*cos(qsr) + sin(qey)*cos(qer)*cos(qsp) + sin(qsp)*sin(qsr)*cos(qer)*cos(qey)) - whz*(-sin(qey)*sin(qsp)*sin(qsr) + cos(qey)*cos(qsp))) + (-2.0*ewx*(-sin(qer)*cos(qsp)*cos(qsr) + sin(qey)*sin(qsp)*cos(qer) - sin(qsr)*cos(qer)*cos(qey)*cos(qsp)) - 2.0*ewy*(-sin(qer)*sin(qey)*sin(qsp) + sin(qer)*sin(qsr)*cos(qey)*cos(qsp) - cos(qer)*cos(qsp)*cos(qsr)) - 2*whx*(-sin(qer)*cos(qsp)*cos(qsr) + sin(qey)*sin(qsp)*cos(qer) - sin(qsr)*cos(qer)*cos(qey)*cos(qsp)) - 2*why*(-sin(qer)*sin(qey)*sin(qsp) + sin(qer)*sin(qsr)*cos(qey)*cos(qsp) - cos(qer)*cos(qsp)*cos(qsr)))*(-1.0*bsx - 1.0*ewx*(sin(qer)*sin(qey)*sin(qsp) - sin(qer)*sin(qsr)*cos(qey)*cos(qsp) + cos(qer)*cos(qsp)*cos(qsr)) - 1.0*ewy*(-sin(qer)*cos(qsp)*cos(qsr) + sin(qey)*sin(qsp)*cos(qer) - sin(qsr)*cos(qer)*cos(qey)*cos(qsp)) - 1.0*ewz*(sin(qey)*sin(qsr)*cos(qsp) + sin(qsp)*cos(qey)) - 1.0*sex*cos(qsp)*cos(qsr) + 1.0*sey*sin(qsr)*cos(qsp) - 1.0*sez*sin(qsp) + spx - whx*(sin(qer)*sin(qey)*sin(qsp) - sin(qer)*sin(qsr)*cos(qey)*cos(qsp) + cos(qer)*cos(qsp)*cos(qsr)) - why*(-sin(qer)*cos(qsp)*cos(qsr) + sin(qey)*sin(qsp)*cos(qer) - sin(qsr)*cos(qer)*cos(qey)*cos(qsp)) - whz*(sin(qey)*sin(qsr)*cos(qsp) + sin(qsp)*cos(qey)))]]]


Rxp.T*Rxc:
[rxx*(sin(qer)*sin(qey)*sin(qsp) - sin(qer)*sin(qsr)*cos(qey)*cos(qsp) + cos(qer)*cos(qsp)*cos(qsr)) + rxy*(sin(qer)*cos(qey)*cos(qsr) + sin(qsr)*cos(qer)) + rxz*(sin(qer)*sin(qey)*cos(qsp) + sin(qer)*s
in(qsp)*sin(qsr)*cos(qey) - sin(qsp)*cos(qer)*cos(qsr))]


Rxp.T*Rxc derivative:
[[[rxx*(sin(qer)*sin(qey)*cos(qsp) + sin(qer)*sin(qsp)*sin(qsr)*cos(qey) - sin(qsp)*cos(qer)*cos(qsr)) + rxz*(-sin(qer)*sin(qey)*sin(qsp) + sin(qer)*sin(qsr)*cos(qey)*cos(qsp) - cos(qer)*cos(qsp)*cos(qsr))]]]
[]
[[[rxx*(-sin(qer)*cos(qey)*cos(qsp)*cos(qsr) - sin(qsr)*cos(qer)*cos(qsp)) + rxy*(-sin(qer)*sin(qsr)*cos(qey) + cos(qer)*cos(qsr)) + rxz*(sin(qer)*sin(qsp)*cos(qey)*cos(qsr) + sin(qsp)*sin(qsr)*cos(qer))]]]
[]
[[[rxx*(sin(qer)*sin(qey)*sin(qsr)*cos(qsp) + sin(qer)*sin(qsp)*cos(qey)) - rxy*sin(qer)*sin(qey)*cos(qsr) + rxz*(-sin(qer)*sin(qey)*sin(qsp)*sin(qsr) + sin(qer)*cos(qey)*cos(qsp))]]]
[]
[[[rxx*(-sin(qer)*cos(qsp)*cos(qsr) + sin(qey)*sin(qsp)*cos(qer) - sin(qsr)*cos(qer)*cos(qey)*cos(qsp)) + rxy*(-sin(qer)*sin(qsr) + cos(qer)*cos(qey)*cos(qsr)) + rxz*(sin(qer)*sin(qsp)*cos(qsr) + sin(qey)*cos(qer)*cos(qsp) + sin(qsp)*sin(qsr)*cos(qer)*cos(qey))]]]

